
<!-- <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Open Modal</button> -->
<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Instruções</h4>
      </div>
      <div class="modal-body">
        <div class = "modal-content-wrapper flexbox">
          <%= image_tag("time-3.svg") %>
          <p>Qualquer encomenda deve ser feita com pelo menos 48h de antecedência.</p>
        </div>
        <div class = "modal-content-wrapper flexbox">
          <%= image_tag("round-euro.svg") %>
          <p>O pagamento é feito no acto da entrega. Pode pagar em numerário ou multibanco.</p>
        </div>
        <div class = "modal-content-wrapper flexbox">
          <%= image_tag("delivery.svg") %>
          <p>Pode escolher receber a encomenda numa morada específica ou levanta-la na loja.</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
      </div>
    </div>

  </div>
</div>

<div class="banner-doughs" style = "padding-bottom: 100px; padding-top: 100px;">
  <div class="container">

    <div id="progresstracker">
      <ul>
        <li id = "wiz-1" class = "active complete" ><span>1</span></li>
        <li id = "wiz-2" ><span>2</span></li>
        <li id = "wiz-3" ><span>3</span></li>
        <li id = "wiz-4"><span>4</span></li>
      </ul>
    </div>

    <div class="form-wrapper">
      <div class="form-inner-wrapper">
        <div class="form-scroll">
         <div class="row row-height" id = "dynamic-content">
          <%= render 'dough' %>
        </div>
      </div>
    </div>
    <div id="pre-down-nav">
      <div class = "pre-down-nav-btn"></div>
      <div class = "pre-down-nav-btn"></div>
      <div class = "pre-down-nav-btn" id = "cart-total">
        <p>Total</p>
      </div>
    </div>
    <div id = "down-nav">
      <div class = "down-nav-btn"><%= image_tag("tail-left.svg") %></div>
      <div class = "down-nav-btn" id="submit-btn"><%= image_tag("tail-right.svg") %></div>
      <div class = "down-nav-cart">
        <p id = "cart"></p>
      </div>
    </div>
  </div>
  <%= link_to design_path, class: "navbar-ac-link" do %>
  Não encontra o que quer?
  <% end %>
</div>
</div>

<% content_for(:after_js) do %>
<script>
  $(document).ready(function(){
    $('#myModal').modal('toggle');
    $("#step1").attr('class', 'hidden'); //hide submit button
    $(".radio-hide").attr('class', 'hidden'); //hide radio buttons
    $('.i-filling').click(function(){
      //Get dough id
      var doughId =  $(this).parent().attr('id');
      var split = doughId.split("fil_dough_");
      var doughIdNum = Number(split[1]);
      //Get filling id
      var fillingId = $(this).attr('id');
      var splitFill = fillingId.split("i_");
      var fillingIdNum = Number(splitFill[1]);
      //Select filling
      $(this).addClass("radio-circle-full");
      //Remove selection of all other fillings
      $(".i-filling").not(this).removeClass("radio-circle-full");
      //Select corresponding radio button and remove others
      $("#cake_filling_" + fillingIdNum).prop('checked', true);
      $(".filling-radio").not(this).prop('checked', false);
      //Select corresponding dough
      $("#cake_dough_" + doughIdNum).prop("checked", true);
      $("#dough_i_" + doughIdNum).addClass("label-color");
      //Remove color and selection from all the other doughs
      $('.dough-label').not("#dough_i_" + doughIdNum).removeClass("label-color");
      //When choosing dough, remove color and selection from all fillings belonging to other doughs
      $("#div_" + doughIdNum + " i").removeClass("radio-circle");
      $("#div_" + doughIdNum + " i").addClass("radio-circle-color");
      //Add price to cart
      $("#cart").empty();
      $("#cart").append("<%= @doughs.first.price_cents%>€/Kg");
    });
    $("#submit-btn").click(function(e){
      if (($("*[id*=cake_dough_]").is(":checked") == true) && ($("*[id*=cake_filling_]").is(":checked") == true)) {
        $("#step1").click();
      }
    })
  })
</script>
<% end %>
